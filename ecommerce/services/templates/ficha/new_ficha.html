{% extends 'core/base.html' %}
{% block title %}
	{{block.super}} - Ficha Banho/Tosa
{% endblock title %}
{% load static %}
{% load bootstrap %}
{% block content %}
<section class="container mt-3">
	<form class="" method="POST" action="."> 
		<legend class="border-bottom pb-2 text-secondary mb-3">
			<i class="fa-solid fa-file mr-2 text-info"></i> Ficha de Banho e Tosa
		</legend>
		{% csrf_token %}
		<div class="container">
			{% if pet.pet_peso.last == None %}
				<a href="{% url 'fichas:peso:peso_add' pk=pet.id %}">
					<p class="alert alert-info text-center">
						<i class="fa-solid fa-triangle-exclamation mr-2"></i>
						O Pet ainda não foi pesado, clique aqui para adicionar o peso.
					</p>
				</a>
			{% endif %}
			<!-- 01 Block Dados Do Animal -->
			<div class="border dados-pet mb-4">
				<div class="bg-dark dados-pet-header pt-2">
					<div class="row px-4">
						<div class="w-75 col">
							<h6 class="font-weight-bold text-white">Dados do animal</h6>
						</div>
						<div class="text-white text-center w-25">
							<h6 class="font-weight-bold">Id: {{pet.id}}</h6>					
						</div>	
					</div>	
				</div>

				<div class="row p-4">
					<div class="col-md-3">
						<label class="text-info font-weight-bold">Nome</label> 
						<label class="text-secondary">{{pet.nome}}</label>
					</div>			
					<div class="col-md-3">
						<label class="text-info font-weight-bold">Idade</label>
						<label class="text-secondary">{{pet.idade}} {{msg}}</label>
					</div>	
					<div class="col-md-3">
						<label class="text-info font-weight-bold">Cor</label> 
						<label class="text-secondary">{{pet.coloracao}}</label>
					</div>	
					<div class="col-md-3">
						<label class="text-info font-weight-bold">Espécie</label> 
						<label class="text-secondary">{{pet.especie}}</label>
					</div>	
					<div class="col-md-3">
						<label class="text-info font-weight-bold">Raça</label> 
						<label class="text-secondary">{{pet.raca.raca}}</label>
					</div>	
					<div class="col-md-3">
						<label class="text-info font-weight-bold">Sexo</label> 
						<label class="text-secondary">{{pet.sexo}}</label>
					</div>	
					<div class="col-md-3">
						<label class="text-info font-weight-bold">Castrado</label> 
						{% if pet.castracao == True %}
							<label class="text-secondary">Sim</label>
						{% else %}
							<label class="text-secondary">Não</label>
						{% endif %}
					</div>	
					<div class="col-md-3">
						<label class="text-info font-weight-bold">Peso<small>(Kg)</small></label>
						{% if pet.pet_peso.last %}
							<label class="text-secondary">{{pet.pet_peso.last.peso}}</label>
						{% else %}
							<small class="text-danger">Peso não encontrado.</small>
						{% endif %}
					</div>	
				</div>
			</div>
			<!-- 02 Block Dados do Tutor -->
			<div class="border-bottom pb-2 mb-4">
				{% for tutor in pet.tutor.all %}
					<div class="row px-4 font-weight-bold text-secondary py-2">
						<label class="d-block col w-75">Dados do Tutor</label>
						<label class="d-blck w-25 text-center">Id: {{tutor.id}}</label>					
					</div>				
					<div class="row px-4">
						<div class="col-md-3">
							<label class="font-weight-bold text-info">Nome</label>
							<label class="text-secondary">{{tutor.first_name}}</label>
						</div>
						{% for profile in tutor.profile.all %}
							<div class="col-md-3">
								<label class="font-weight-bold text-info">CPF</label>
								<label class="text-secondary">{{profile.cpf}}</label>
							</div>
							<div class="col-md-3">
								<label class="font-weight-bold text-info">Telefone</label>
								<label class="text-secondary">{{profile.telefone}}</label>
							</div>
						{% endfor %}
						<div class="col-md-3">
							<label class="font-weight-bold text-info">Email</label>
							<label class="text-secondary">{{tutor.email}}</label>
						</div>
					</div>
				{% endfor %}	
			</div>
			<!-- 03 Block Anamnese -->
			<div class="border dados-pet mb-4">
				<div class="bg-info dados-pet-header pt-2">
					<div class="row px-4">
						<div class="w-75 col">
							<h6 class="font-weight-bold text-white">Anamnase</h6>
						</div>
						<div class="text-white text-center w-25">
							<h6 class="font-weight-bold">{{anamnese.created|date:'Y'}}</h6>					
						</div>	
					</div>	
				</div>

				<div class="row p-4">
					{% if anamnese %}
							<div class="row">
								{{anamnese.id}}
							</div>					
						<button class="btn btn-outline-info" type="button" onclick="location.href='{% url 'fichas:ficha_add' pk=pet.id %}'">
							<i class="fa-solid fa-plus"></i> Anamnese
						</button>
					{% else %}
						<p class="alert alert-info">Ainda não foram realizadas nenhuma anamneses no pet.</p>
						<button class="btn btn-outline-info" type="button" onclick="location.href='{% url 'fichas:ficha_add' pk=pet.id %}'">
							<i class="fa-solid fa-plus"></i> Anamnese
						</button>
					{% endif %}
				</div>
			</div>
			<div class="row px-4">
				{% for item in form %}
					<div class="row mr-3">{{item|bootstrap}}</div>
				{% endfor %}
				{{anamnese.management_form}}

			</div>
			<button class="btn btn-info mr-3" type="submit">Criar Ficha</button>
			<button class="btn btn-outline-info" type="button" onclick="location.href='{% url 'pet:pet_detail' pk=pet.id %}'">Cancelar</button>
		</div>	
	</form>
</section>
{% endblock %}